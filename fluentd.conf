<source>
  @type tail
  path C:/Program Files/pGina/log/pGina.Service.ServiceHost_log.txt
  pos_file C:/authnull-agent/fluentd/ldap.pos
  tag windows-agent.log
  <parse>
    @type none
  </parse>
</source>

<filter windows-agent.log>
  @type grep
  <regexp>
    key message
      pattern /LdapPlugin: Authnull (Authz )?Service CallAuthnull Method 1:.*(Success|failure)/
  </regexp>

</filter>

<filter windows-agent.log>
  @type parser
  key_name message
  format json
  reserve_data true
  </filter>

<filter windows-agent.log>
  @type record_transformer
  enable_ruby true
  <record>
orgId 84
tenantId 7
component "ldap-logs"    
  </record>
</filter>

<match windows-agent.log>
  @type stdout
</match>
